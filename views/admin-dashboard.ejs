<%- include('partials/header') %>

<div class="container">
    <h1 style="margin-bottom: 2rem;">Admin Dashboard</h1>

    <div class="grid" style="margin-bottom: 3rem;">
        <div class="card" style="text-align: center;">
            <div class="card-icon" style="color: var(--secondary);"><ion-icon name="people"></ion-icon></div>
            <h3 class="card-title"><%= studentCount %></h3>
            <p class="card-desc">Total Students</p>
            <a href="/admin/students" class="btn btn-primary">Manage Students</a>
        </div>
        <div class="card" style="text-align: center;">
            <div class="card-icon" style="color: var(--success);"><ion-icon name="library"></ion-icon></div>
            <h3 class="card-title"><%= resourceCount %></h3>
            <p class="card-desc">Total Resources</p>
            <div style="display: flex; gap: 0.5rem; justify-content: center; margin-top: 1rem;">
                <a href="/admin/resource/add" class="btn btn-success" style="background-color: var(--success); color: white; padding: 0.5rem 1rem; font-size: 0.9rem;">Add New</a>
                <a href="/admin/resources" class="btn btn-outline" style="padding: 0.5rem 1rem; font-size: 0.9rem;">View All</a>
            </div>
        </div>
    </div>

    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
        <h2 style="margin: 0;">Recent Resources</h2>
        <a href="/admin/resources" style="color: var(--primary); text-decoration: none; font-weight: 500;">View All &rarr;</a>
    </div>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Category</th>
                    <th>Type</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <% recentResources.forEach(res => { %>
                    <tr>
                        <td><%= res.title %></td>
                        <td><span class="status-badge" style="background: rgba(99,102,241,0.2); color: var(--primary);"><%= res.category %></span></td>
                        <td style="text-transform: capitalize;">
                            <% if (res.type === 'pdf') { %>
                                <span class="status-badge" style="background: rgba(239, 68, 68, 0.15); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.2); display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px;">
                                    <ion-icon name="document-text-outline" style="font-size: 1.1rem;"></ion-icon> PDF
                                </span>
                            <% } else if (res.type === 'video') { %>
                                <span class="status-badge" style="background: rgba(59, 130, 246, 0.15); color: #3b82f6; border: 1px solid rgba(59, 130, 246, 0.2); display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px;">
                                    <ion-icon name="play-circle-outline" style="font-size: 1.1rem;"></ion-icon> Video
                                </span>
                            <% } else { %>
                                <span class="status-badge" style="background: rgba(107, 114, 128, 0.15); color: #6b7280; border: 1px solid rgba(107, 114, 128, 0.2); padding: 4px 10px;">
                                    <%= res.type %>
                                </span>
                            <% } %>
                        </td>
                        <td>
                            <a href="/admin/resource/edit/<%= res._id %>" class="btn btn-outline" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">Edit</a>
                            <form action="/admin/resource/delete/<%= res._id %>" method="POST" style="display: inline;">
                                <button type="submit" class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-left: 0.5rem;" onclick="return confirm('Delete this resource?')">Delete</button>
                            </form>
                        </td>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
</div>

<%- include('partials/footer') %>
